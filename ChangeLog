2009-10-05  Dirk Bergstrom  <krid@otisbean.com>

	* app/assistants/locked-assistant.js: Fix bad path to new-password dialog.

2009-10-04  Dirk Bergstrom  <krid@otisbean.com>

Add initializing/locked scene to fix race condition, and to allow for more
lockout options.  Add option to require password at launch. 

	* app/assistants/app-assistant.js (windowDeactivated): Choose action
	based on ring.prefs; use Keyring methods for lockout.
	(pushOpeningScene): Push "locked" scene instead of item list.  This avoids
	a race-condition that would often lead to showing the "new password"
	dialog on launch.
	(PasswordDialogAssistant): Add option to prevent canceling of dialog.
	Better formatting for error display.  Focus password input on error.
	(Keyring.doIfPasswordValid): Handle preventCancel arg.
	(Keyring.lockout,activateLockout,deactivateLockout): Factored out code
	from the scenes and collected it here for simplicity.  Supports
	different behaviors per preferences.

	* app/assistants/actions-assistant.js (setup): Properly handle labels on
	ListSelectors.
	(exportToUrl): Proper error handling.
	(importFileOrUrl): Fix a really dumb bug.  Proper error handling.
	(clearDatabase): Pop to appropriate scene.
    (activate, deactivate, timeoutOrDeactivate): Use new Keyring-based
	global system for lockout/timeout.
	(ImportExportDialogAssistant): Make OK button an activity button, and
	don't allow double-submit.
	
	* app/assistants/item-assistant.js (timeoutOrDeactivate): Use new Keyring
	based global system for lockout/timeout.
	
	* app/assistants/item-list-assistant.js (activate, deactivate,
	timeoutOrDeactivate): Use new Keyring-based global system for
	lockout/timeout.
	
	* app/assistants/help-assistant.js (activate, deactivate,
	timeoutOrDeactivate): Use new Keyring-based global system for
	lockout/timeout.
	
	* app/assistants/locked-assistant.js: New scene used at launch and
	(optionally) as an app-locked screen.  Home to the "create master
	password" dialog.  
	
	* app/assistants/preferences-assistant.js (setup): Add plumbing for new
	lockout prefs.  Properly handle labels on ListSelectors.
	(activate, deactivate, timeoutOrDeactivate): Use new Keyring-based
	global system for lockout/timeout.
	
	* app/models/ring.js (DEFAULT_PREFS): New prefs for lockout behavior.
	(onDeactivateOptions): What to do when minimized.
	(initDepotReader): Return early if data already loaded.
	(_loadDepotData): Note loading of data earlier in the cycle.
	(_loadDataHandler): Fill in any missing prefs.
	
	* app/views/help/help-scene.html: Added Change Log section.
	
	* app/views/locked/locked-scene.html: New initializing/locked scene.
	
	* app/views/locked/new-password-dialog.html: Hook for better error
	formatting.  Moved to new "locked" scene.
	
	* app/views/password-dialog.html: Hook for better error formatting.
	
	* app/views/preferences/preferences-scene.html: Added new prefs for lockout.
	Reorganized prefs into "paranoia" section.  Cleanup up L&F.

2009-09-28  Dirk Bergstrom  <krid@otisbean.com>

Fix a bug in V0 upgrader.  Add user-visible display of ring.errors.  Fix some
import bugs.

	* app/assistants/help-assistant.js (setup): Display any ring.errors at the
	bottom of the scene, so we can get users to tell us what's wrong.
	(timeoutOrDeactivate): Pop to items-list scene explicitly, to avoid
	exposing a key.
	
	* app/assistants/preferences-assistant.js (timeoutOrDeactivate): Pop to
	items-list scene explicitly, to avoid exposing a key.
	
	* app/assistants/actions-assistant.js (timeoutOrDeactivate): Pop to
	items-list scene explicitly, to avoid exposing a key.
	(clearDatabase): Pop to items-list explicitly.
	(exportToUrl): Clean up URL prior to using it.
	(setup): Adjust to new ring.resolutions format.
	(importFileOrUrl): Save URL/file prefs before importing.  Fix password
	argument passing bug.
	
	* app/assistants/item-assistant.js (timeoutOrDeactivate): Pop to
	items-list scene explicitly, to avoid exposing a key.
	
	* app/models/ring.js (errors): Always push error string into errors array,
	so that they can be displayed to the user.
	(importData, resolutions): Fix a bug in resolutions definition and
	handling.
	
	* app/models/upgrader.js (processData): Wrap in try/catch block so
	we can properly report errors.
	(loadPrefs, processData): Fix null dereference bug in prefs handling.
	(loadDepotData, deleteOldData): Better error reporting.

	* app/views/help/help-scene.html: Added optional errors display.

2009-09-27  Dirk Bergstrom  <krid@otisbean.com>

	* app/assistants/actions-assistant.js: New scene for import / export and
	clear database.
	
	* app/assistants/item-list-assistant.js (NewPasswordDialogAssistant):
	I18n for hints.  Enter now submits in second input.
	(sortPopupHandler): Call correct save method.
	(*): Various small syntax fixes.
	(PasswordDialogAssistant, doIfPasswordValid): Move to app-assistant.
	
	* app/assistants/app-assistant.js (PasswordDialogAssistant): Move here
	from item-list-assistant so it can be used globally.  Unlock button
	no longer an activity button.
	(Keyring.MenuModel): Add "Database Actions" menu item.
	(setup): Use Mojo.appInfo.version instead of fancy ajax call.
	(handleCommand): Check password before opening prefs and actions scenes.
	
	* app/assistants/preferences-assistant.js: Call correct save method.
	Move clear database functionality to actions-assistant.
	
	* app/models/ring.js: Add methods & prefs for import/export.
	(_dataObject): Helper method used by saveData and export.
	(clearDatabase): Regenerate salt during factory reset.
	
	* app/models/upgrader.js: Handle import/export prefs.  Switch order of
	classes to make jslint happy.
	
	* app/views/help/help-scene.html: Rearrange, add index, add section about
	import/export.
	
	* app/views/item-list/new-password-dialog.html: Add welcome message and
	instructions.
	
	* package.sh: Simple script to generate .ipk file.

2009-09-19  Dirk Bergstrom  <krid@otisbean.com>

	* app/models/ring.js (depot methods): Store all depot data under a single
	key, which simplifies loading and storing considerably.
	(password & encryption methods): Cache key (sha256 of salt+pass) instead
	of password.
	(_checkData, newPassword, validatePassword): Use _key as checkData
	plaintext, instead of static value.
	(SCHEMA_VERSION, _loadDepotData, saveData): Handle data versioning
	and upgrading.
	(clearDatabase): Fix password check.  Revise factory reset logic.
	(buildItemList): Default to TITLE as sortKey.
	
	* app/models/upgrader.js: New classes to handle upgrading depot when
	the schema changes.
	
	* app/assistants/item-assistant.js (setup): Clean up hiding of dates row.

	* app/assistants/item-list-assistant.js (aboutToActivate): Reflect
	new name of ring init method.

	* app/assistants/preferences-assistant.js (deactivate): Properly stop
	listening to clear db button.

	* app/views/preferences/preferences-scene.html: Render checkboxes on a
	single row.
	
	* app/views/item/item-scene.html: Give an id to url-row, as part of
	date-row hiding cleanup.
	
	* app/views/item/generate-password-dialog.html: Render checkboxes on a
	single row.
	
	* stylesheets/keyring.css: Add class to allow multiple checkboxes on a
	single row.
	
2009-09-11  Dirk Bergstrom  <krid@otisbean.com>

	* README.txt: A little something to help folks on GitHub understand.

2009-09-10  Dirk Bergstrom  <krid@otisbean.com>

	* app/assistants/app-assistant.js (setup, fileReadCallback): Get version
	number by reading appinfo.json via an ajax call.

0.0.2 - Fixed a couple bugs:
 - Generated passwords didn't get put into the model properly.
 - Changed values in focused fields lost on timeout-initiated scene pop. 

0.0.1 - Initial release